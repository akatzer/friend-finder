<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Friend Finder!</title>
    <!-- Latest compiled and minified CSS & JS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

</head>

<body>

    <div class="container">
        <div class="jumbotron">
            <h1>Austin's Friend Finder App</h1>
            <h3>The greatest resource in the galaxy for friends!</h3>
        </div>
        <div class="row">

            <div class="col-lg-12">
                <form id="form">

                    <div class="form-group">
                        <label for="firstName">Name</label>
                        <input type="text" class="form-control" id="name" placeholder="First Name">

                    </div>

                    <div class="form-group">
                        <label for="photoUrl">Photo URL</label>
                        <input type="text" class="form-control" id="photoUrl" placeholder="Enter Photo URL">
                    </div>

                </form>
                <button type="submit" class="btn btn-primary" id="showQuiz">Take The Survey</button>

                <form id="quiz">

                    <label>I see myself as extraverted, enthusiastic.</label>
                    <br>
                    <div>
                        <select class="form-control" id="question1">
                            <option value="" selected disabled>Choose</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                    </div>
                    <br>

                    <label>I see myself as critical, quarrelsome.</label>
                    <br>
                    <div>
                        <select class="form-control" id="question2">
                            <option value="" selected disabled>Choose</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                    </div>
                    <br>

                    <label>I see myself as dependable, self-disciplined.</label>
                    <br>

                    <div>
                        <select class="form-control" id="question3">
                            <option value="" selected disabled>Choose</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                    </div>
                    <br>

                    <label>I see myself as anxious, easily upset.</label>
                    <br>
                    <div>
                        <select class="form-control" id="question4">
                            <option value="" selected disabled>Choose</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                    </div>
                    <br>

                    <label>I see myself as open to new experiences, complex.</label>
                    <br>
                    <div>
                        <select class="form-control" id="question5">
                            <option value="" selected disabled>Choose</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                    </div>
                    <br>

                    <label>I see myself as reserved, quiet.</label>
                    <br>
                    <div>
                        <select class="form-control" id="question6">
                            <option value="" selected disabled>Choose</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                    </div>
                    <br>

                    <label>I see myself as sympathetic, warm.</label>
                    <br>
                    <div>
                        <select class="form-control" id="question7">
                            <option value="" selected disabled>Choose</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                    </div>
                    <br>

                    <label>I see myself as disorganized, careless.</label>
                    <br>
                    <div>
                        <select class="form-control" id="question8">
                            <option value="" selected disabled>Choose</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                    </div>
                    <br>

                    <label>I see myself as calm, emotionally stable.</label>
                    <br>
                    <div>
                        <select class="form-control" id="question9">
                            <option value="" selected disabled>Choose</option>
                            <option value="" selected disabled>Choose</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                    </div>
                    <br>

                    <label>I see myself as conventional, uncreative.</label>
                    <br>
                    <div>
                        <select class="form-control" id="question10">
                            <option value="" selected disabled>Choose</option>
                            <option value="1">1 (Strongly Disagree)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5 (Strongly Agree)</option>
                        </select>
                    </div>
                    <br>

                </form>
                <button type="submit" class="btn btn-primary" id="submitQuiz">Submit</button>
                <button type="submit" class="btn btn" id="goBack">Go Back</button>
                <br><br><br>
            </div>
        </div>
    </div>

    <!-- this is the modal  -->
    <div class="modal fade" id="modal" tabindex="-1" role="dialog" aria-labelledby="modal" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalTitle">Your Match...</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    ...
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>

                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        // runs the show form function when the page loads
        showForm();

        // function that shows the survey
        function showQuiz() {
            $("#goBack").show();
            $("#submitQuiz").show();
            $("#quiz").show();
            $("#form").hide();
            $("#showQuiz").hide();
        }

        // function that shows the form
        function showForm() {
            $("#goBack").hide();
            $("#submitQuiz").hide();
            $("#quiz").hide();
            $("#form").show();
            $("#showQuiz").show();
        }

        // on click event that checks to make sure a name and url has been entered and then shows the survey
        $("#showQuiz").on("click", function () {
            if ($("#name").val() == "" || $("#photoUrl").val() == "") {
                alert("Enter your name and image URL");
            }
            else {
                showQuiz();
            }            
        });

        // a button that takes you back to the name/url section
        $("#goBack").on("click", function () {
            showForm();
        })

        // submits all the information that has been entered and clears out the form for the next entry
        $("#submitQuiz").on("click", function () {
            event.preventDefault();

            //pulls the data from the survey and puts it into the new friend variable
            var newFriend = {
                name: $("#name").val().trim(),
                photoUrl: $("#photoUrl").val().trim(),
                scores: [
                    parseInt($("#question1").val().trim()),
                    parseInt($("#question2").val().trim()),
                    parseInt($("#question3").val().trim()),
                    parseInt($("#question4").val().trim()),
                    parseInt($("#question5").val().trim()),
                    parseInt($("#question6").val().trim()),
                    parseInt($("#question7").val().trim()),
                    parseInt($("#question8").val().trim()),
                    parseInt($("#question9").val().trim()),
                    parseInt($("#question10").val().trim()),
                ],
            }
         
            //posts the data into the API and toggles our friend match modal this also clearsx out the form and starts the user back on the name/url section.
            $.post("/api/friends", newFriend)
                .then(function (data) {
                    $(".modal-body").html("<p>" + data.matchName + " is your match</p><br><img src='" + data.matchUrl + "'>");
                    $(".modal").modal("toggle");
                    $(".form-control").val("");
                    showForm();
                })
        })
    </script>

</body>
<div class="container">
    <footer>
        <p><a href="/api/friends">API Friends List</a><span> | </span><a href="https://github.com/akatzer/friend-finder">GitHub Repo</a></p>
    </footer>
</div>

</html>